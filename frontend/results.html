<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Search Results - PriceNest</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/results.css" />
</head>

<body>

    <nav>
        <h2 onclick="window.location.href='index.html'">PriceNest</h2>

        <div class="nav-links">
        </div>

        <div class="nav-buttons" id="navButtons">
            <a href="login.html"><button class="btn">Login</button></a>
            <a href="signup.html"><button class="btn primary">Sign Up</button></a>
        </div>
    </nav>

    <div class="container">
        <!-- Search Header -->
        <div class="search-header">
            <h1 id="searchQuery">Loading...</h1>
            <div class="search-box">
                <input id="searchInput" placeholder="Search for another product..." autocomplete="off" />
                <button onclick="handleNewSearch()">Search</button>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab active" data-tab="compare">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="20" x2="18" y2="10"></line>
                    <line x1="12" y1="20" x2="12" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="14"></line>
                </svg>
                Compare
            </button>
            <button class="tab" data-tab="analytics">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
                Analytics
            </button>
            <button class="tab" data-tab="alert">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                Set Alert
            </button>
            <button class="tab" data-tab="ai">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                </svg>
                AI Summary
            </button>
        </div>

        <!-- Tab Contents -->

        <!-- Compare Tab -->
        <div class="tab-content active" id="compare">
            <div class="products-grid" id="productsGrid">
                <div class="spinner"></div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div class="tab-content" id="analytics">
            <div class="analytics-container">
                <div class="analytics-header">
                    <h2>Price Analytics</h2>
                    <p>Historical price trends and insights for this product</p>
                </div>

                <!-- Summary Cards -->
                <div class="stats-grid">
                    <div class="stat-card" id="lowestPrice">
                        <div class="stat-label">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 4px;">
                                <rect x="2" y="6" width="20" height="12" rx="2" />
                                <circle cx="12" cy="12" r="2" />
                                <path d="M6 12h.01M18 12h.01" />
                            </svg>
                            Lowest Price
                        </div>
                        <div class="stat-value">₹0</div>
                    </div>
                    <div class="stat-card" id="avgPrice">
                        <div class="stat-label">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 4px;">
                                <line x1="18" y1="20" x2="18" y2="10"></line>
                                <line x1="12" y1="20" x2="12" y2="4"></line>
                                <line x1="6" y1="20" x2="6" y2="14"></line>
                            </svg>
                            Average Price
                        </div>
                        <div class="stat-value">₹0</div>
                    </div>
                    <div class="stat-card" id="priceRange">
                        <div class="stat-label">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 4px;">
                                <path d="m21 21-4.3-4.3" />
                                <path d="M18 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z" />
                                <path d="M18 16.88A7.03 7.03 0 1 1 15.88 21" />
                            </svg>
                            Price Range
                        </div>
                        <div class="stat-value">₹0</div>
                    </div>
                    <div class="stat-card" id="stabilityScore">
                        <div class="stat-label">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 4px;">
                                <polyline points="23 18 13.5 8.5 8.5 13.5 1 6" />
                                <polyline points="17 18 23 18 23 12" />
                            </svg>
                            Stability
                        </div>
                        <div class="stat-value">0</div>
                    </div>
                </div>

                <!-- Store Bar Chart -->
                <div class="chart-section">
                    <h3 style="margin-bottom: 16px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                            <polyline points="9 22 9 12 15 12 15 22" />
                        </svg>
                        Store-wise Price Comparison
                    </h3>
                    <div class="chart-container">
                        <canvas id="storeChart"></canvas>
                    </div>
                </div>

                <!-- Price Trend with Toggle -->
                <div class="chart-section">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 8px;">
                                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17" />
                                <polyline points="16 7 22 7 22 13" />
                            </svg>
                            Price Trend Over Time
                        </h3>
                        <div class="toggle-group" style="display: flex; gap: 8px;">
                            <!-- Removed hourly/daily toggles, enforcing weekly chart -->
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <!-- Insight & Consistency Table -->
                <div class="insight-consistency-grid">
                    <div class="insight-section">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 8px;">
                                <path
                                    d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A5 5 0 0 0 8 8c0 1.3.5 2.6 1.5 3.5.8.8 1.3 1.5 1.5 2.5" />
                                <path d="M9 18h6" />
                                <path d="M10 22h4" />
                            </svg>
                            Best Time-to-Buy Insight
                        </h3>
                        <div class="stat-card">
                            <p id="buyInsight">Analyze a product to see insights.</p>
                        </div>
                    </div>
                    <div class="table-section">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2"
                                style="vertical-align: middle; margin-right: 8px;">
                                <path d="m17 2 4 4-4 4" />
                                <path d="M3 11v-1a4 4 0 0 1 4-4h14" />
                                <path d="m7 22-4-4 4-4" />
                                <path d="M21 13v1a4 4 0 0 1-4 4H3" />
                            </svg>
                            Store Consistency
                        </h3>
                        <div class="stat-card" style="padding: 0; overflow: hidden;">
                            <table id="storeTable" class="analytics-table">
                                <thead>
                                    <tr>
                                        <th>Store</th>
                                        <th>Times Cheapest</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Set Alert Tab -->
        <div class="tab-content" id="alert">
            <div class="alert-form-container">
                <div class="alert-form-header">
                    <h2>Set Price Alert</h2>
                    <p>Get notified when the price drops below your target</p>
                </div>

                <form class="alert-form" id="alertForm">
                    <div class="form-group">
                        <label for="alertProduct">Product Name</label>
                        <input type="text" id="alertProduct" class="form-input" placeholder="Product name" />
                    </div>

                    <div class="form-group">
                        <label for="alertPrice">Target Price (₹)</label>
                        <input type="number" id="alertPrice" class="form-input" placeholder="Enter your target price"
                            required />
                        <small>Current best price: <span id="currentBestPrice">₹0</span></small>
                    </div>

                    <div class="form-group">
                        <label for="alertEmail">Email</label>
                        <input type="email" id="alertEmail" class="form-input" placeholder="your@email.com" required />
                        <small>Connected to: <span id="currentAccountEmail"
                                style="font-weight: bold;">...</span></small>
                    </div>

                    <button type="submit" class="btn primary" style="width: 100%;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        Create Alert
                    </button>
                </form>
            </div>
        </div>

        <!-- AI Summary Tab -->
        <div class="tab-content" id="ai">
            <div class="ai-summary-container">
                <div class="ai-summary-header">
                    <h2>AI-Powered Summary</h2>
                    <p>Coming soon! AI-generated insights and recommendations</p>
                </div>

                <div class="empty-state">
                    <div class="empty-state-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 8V4H8"></path>
                            <rect width="16" height="12" x="4" y="8" rx="2"></rect>
                            <path d="M2 14h2"></path>
                            <path d="M20 14h2"></path>
                            <path d="M15 13v2"></path>
                            <path d="M9 13v2"></path>
                        </svg>
                    </div>
                    <div class="empty-state-title">AI Summary Feature</div>
                    <div class="empty-state-text">
                        This feature will provide intelligent insights about the product,<br>
                        including price predictions, best time to buy, and personalized recommendations.
                    </div>
                    <button class="btn outline" disabled>Coming Soon</button>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="js/utils.js"></script>
    <script src="js/results.js"></script>

</body>

</html>